
Settings and Control Panel are focused on managing configuration settings for a single computer. In an enterprise environment, configuration and monitoring of hundreds or thousands of desktops require more advanced tools. For example, very commonly, configuration can be achieved more quickly and reliably using command-line tools. In this lesson, you will learn about the appropriate use of advanced interfaces and tools to manage Windows 10 and Windows 11 systems.

Microsoft Management Consoles (MMCs) provide a standard interface for advanced configuration and management of Windows desktops and servers. You can use these consoles to manage security settings, set up scheduled tasks, and manage the disk subsystem. Additionally, when a configuration setting is not exposed in any of the normal GUI tools, you will need to use the Registry Editor to solve some types of issues.


# Device Manager
----
**Device Manager (devmgmt.msc)** allows you to view and edit the properties of installed hardware. You can change hardware configuration settings, update drivers, or remove/disable devices.

### Updating and Troubleshooting Devices

Sometimes Windows can determine a device's type and function but cannot locate a driver for the device (perhaps there is no driver included on the Windows setup media or in Windows Update). In this case, you may find an "Unknown Device," or device of a "generic" type listed in the Device Manager with a yellow exclamation mark indicating a problem.

If the device has never worked, check that it (or the driver installed) is compatible with the OS. Manufacturers often release updated drivers to fix known problems. The update can normally be obtained as a download from the support area of the manufacturer's website. Once downloaded, the driver may come with a setup program to install it or may need to be installed manually.

*Alternatively, driver updates might be supplied via Windows Update. They are typically listed as optional updates.*

To update or troubleshoot a device manually, in the Device Manager hardware tree, locate the device, right-click it, and select **Properties** to display the device settings. The **General** tab displays status information for the device. Use the **Update Driver** button on the **Drivers** tab to install a new driver.

![](Meta/Pasted%20image%2020231018133456.png)

*Using device properties to investigate driver and roll back to a previous version*

### Removing, Uninstalling, and Disabling Devices

If a device supports Plug and Play and is hot swappable, you can remove it from the computer without having to uninstall it. Before removing a storage device, close any applications that might be using it, then select the **Safely Remove Hardware** icon in the notification area on the taskbar, and choose the option to stop or eject the device.

Physically removing a device leaves the driver installed so that it will be detected if the device is reconnected. To remove the driver, before physically unplugging the device, right-click it and select **Uninstall device**.

![](Meta/Pasted%20image%2020231018133549.png)

There is also an option in Device Manager to **Disable** a device, which you might use if it is not working with the current driver and you want to make it inaccessible to users while you find a replacement. Devices that cannot be physically uninstalled easily may also be disabled to improve system security. Disabled devices are shown with a down arrow.

# Disk Management Console
----

The disk subsystem stores all the information generated by installing the operating system and using software applications to create data files. As the primary store of so much data, ensuring the reliability and performance of the disk subsystem is a critical management task.

The **Disk Management (diskmgmt.msc)** console displays a summary of any fixed and removable disks—hard disk drives (HDDs), solid state drives (SSDs), and optical drives—attached to the system. HDDs and SSDs can be divided into logical partitions. Each partition is represented as a volume in the top pane.

![](Meta/Pasted%20image%2020231018133619.png)
*Disk Management Console*

*The terminology of drives, volumes, and partitions can be confusing. Partitions are configured on HDDs and SSDs. A volume is a logical storage unit made available to the OS. There could be a simple 1:1 mapping between a partition and a volume. However, a volume can also be created using a redundant drive configuration (RAID) where there are actually multiple devices and partitions supporting the volume. In Windows, “drive” refers to a volume that has been mapped to a letter. However, drive is very frequently used to mean a hardware storage device too.*

One of the disks (typically Disk 0) will be the one holding the operating system. This disk will have at least three volumes:

- The system volume contains the files used to boot the OS. This typically uses a boot system called extensible firmware interface (EFI). It is not usually assigned a drive letter.
- The boot volume contains the operating system files and is usually allocated the drive letter C:.
- Recovery partitions contain tools to repair a damaged installation and/or return the computer to its factory state. These can either contain the PC vendor’s tool or Microsoft’s Windows Recovery Environment (WinRE). They are not usually assigned drive letters.

The Disk Management console supports the following disk and partitioning tasks:

- **Initializing disks**—If you add an unformatted HDD, SSD, or thumb drive, you will be prompted to initialize it. You can choose whether to use the master boot record (MBR) or Globally Unique ID (GUID) Partition Table (GPT) partition style for the new disk. MBR and GPT refer to the way the partition information is stored on the disk.
- **Partitioning**—Each disk must be configured with at least one partition. You can create a new partition by right-clicking on an area of unpartitioned space. A wizard will prompt you to choose how much of the unallocated space to use and to select a file system.
- **Formatting**—A new partition must be written with a file system—typically NTFS—to allow Windows to write and read files. The simpler FAT32 file system might be used for small, removable drives. You can also reformat existing partitions. This will delete all files from the volume. Along with the file system type, you can choose a volume label and allocation unit size.

*The smallest unit of storage on a fixed disk has traditionally been the 512-byte sector. A file system is not restricted to using a single sector as the basic unit of storage, however. The file system can group sectors into allocation units/clusters of 2, 4, or 8 sectors. Smaller clusters make more efficient use of the disk capacity, but using larger clusters can improve file input/output (I/O) performance, especially when working with large files. As fixed disk sizes have increased, some disk models now use Advanced Format, with 4 kilobyte (4K) sector sizes. If supported by the OS and PC firmware, these can be used in native mode; if not, the drive controller will usually present the disk in 512 emulated (512e) mode.*

*_You cannot format or delete system or boot partitions. During setup, the boot partition must be formatted as NTFS, and the system partition must be formatted as FAT32._*

- **Repartitioning**—Existing partitions can be expanded if there is unpartitioned space. Partitions can also be removed or shrunk to make space available.
- **Configuring dynamic disks**—If there is more than one disk available, a new dynamic volume can be configured. Dynamic volumes use multiple devices to implement some type of software RAID redundancy, such as mirroring.

*The dynamic disks feature is deprecated. The Storage Spaces feature is now the preferred method of configuring redundant disk configurations.*



# Disk maintenance Tools
----

Of all the computer's subsystems, disk drives and the file system probably require the most attention to keep in optimum working order. File storage is subject to three main problems:

- **Fragmentation**—On a hard disk, ideally each file would be saved in contiguous clusters on the disk. In practice, over time as files grow, they become fragmented across non-contiguous clusters, reducing read performance.
- **Capacity**—Typically, much more file creation occurs on a computer than file deletion. This means that capacity can reduce over time. If the boot volume has less than 20% free space, performance can be impaired. When space drops below 200 MB, a Low Disk Space warning is generated.
- **Damage**—Hard disk operations are physically intensive, and the platters of the disk are easy to damage, especially if there is a power cut. If the disk does not recognize that a sector is damaged, files can become corrupted. SSDs can suffer from degradation of the memory circuitry, resulting in bad blocks, and can be damaged by impacts, overheating, and electrical issues.

These problems can be addressed by the systematic use of disk maintenance tools. These tools should be run regularly—at least every month and before installing software applications.

### Disk Defragmenter

The **Defragment and Optimize Drives tool (dfrgui.exe)** runs various operations to speed up the performance of HDDs and SSDs:

- On an HDD, defragmenting rewrites file data so that it occupies contiguous clusters, reducing the amount of time the controller has to seek over the disk to read a file.
- On an SSD, data is stored in units called blocks that are not directly managed by the OS. The drive controller determines how blocks are used according to wear-leveling routines to minimize degradation of the solid-state cells. The main purpose of the optimizer tool is to instruct the controller to run a TRIM operation. Essentially, TRIM is a process by which the controller identifies data that the OS has marked as deletable and can then tag corresponding blocks as writable. The optimizer does perform a type of defragmentation operation on an SSD if it holds the OS and the system protection feature Volume Shadow Copy service is enabled.
![](Meta/Pasted%20image%2020231018133808.png)
*_Optimize Drives (Defragmenter) in Windows 10._*

Windows automatically schedules the disk optimizer to run using **Task Scheduler**. You should check for any issues, such as it not running successfully.

### Disk Clean-up

The **Disk Clean-up (cleanmgr.exe**) tool tracks files that can be safely erased to reclaim disk space. These files include ones deleted but still available in the Recycle Bin and various temporary files and caches. The tool can be run in administrator mode using the **Clean up system files** option to reclaim data from caches such as Windows Update and Defender.

![](Meta/Pasted%20image%2020231018133828.png)


# Task Scheduler
----

The **Task Scheduler (tasksch.msc)** runs commands and scripts automatically. Many of Windows's processes come with predefined schedules. Tasks can be run once at a future date or time or according to a recurring schedule. A task can be a simple application process (including switches, if necessary) or a batch file or script. Other features include:

- A trigger can be an event rather than a calendar date/time. For example, a task can be set to run when the user signs in or when the machine wakes from sleep or hibernation.
- Each task can include multiple actions.
- All activity is logged so that you can investigate failed tasks.
- Tasks can be organized in folders.

![](Meta/Pasted%20image%2020231018134011.png)

*Task Scheduler showing a Dell Support auto update task configured to run each week.*

Apart from defining the path to the file or script you want to execute and defining a trigger, you should also enter the credentials that the task will run under—if the selected user account does not have sufficient permissions, the task will not run.



# Local Users and Groups Console
----
The **Local Users and Groups (lusrmgr.msc)** console provides an advanced interface for creating, modifying, disabling, and deleting user accounts. You can also reset the password for an account.

Security groups can be used to collect user accounts that need to be allocated similar permissions, such as the right to edit files in a shared folder. The default groups—such as Administrators, Users, and Guests—implement the account types that can be selected via the settings interface.

![](Meta/Pasted%20image%2020231018134147.png)

*Local Users and Groups console showing default security groups. Adding a user account as a member of the Administrators group gives the account full privileges*

*Users, groups, and sharing/permissions are covered in more detail later in the course.*


# Certificate Manager
----

A digital certificate is a means of proving the identity of a subject, such as a user, computer, or service. The validity of each certificate is guaranteed by the issuing certification authority (CA). The **Certificate Manager console (certmgr.msc)** shows which certificates have been installed and provides a mechanism for requesting and importing new certificates.

The tool displays many subfolders, but the most widely used are:

- The Personal folder stores the certificates that have been issued to the user account. User certificates can be used for tasks such as authenticating to a network access server, encrypting data, and adding a digital signature to a document or message to prove its authenticity.
- Trusted Root Certification Authorities contains a superset of the certificates of all issuers that are trusted, including Microsoft’s own CA root, local enterprise CAs and third-party CAs. Most of these certificates are managed via Windows Update.
- Third-party Root Certification Authorities contains trusted issuers from providers other than Microsoft or a local enterprise.

![](Meta/Pasted%20image%2020231018134228.png)

*Using Certificate Manager to view certificates for the current user. The trusted root certificates added here allow the computer to trust any subject certificates issued by these CAs. Note that as these are root certificates, each is issued to the organization by itself.* 


*certmgr.msc manages certificates for the current user. There is also a computer certificate store, which can be managed via certlm.msc.*

Trusting an unsafe CA raises critical security vulnerabilities. For example, a rogue CA certificate might allow a website to masquerade as a legitimate bank or other service and trick the user into submitting a password because the browser seems to trust the web server’s certificate. In some cases, you may need to use Certificate Manager to remove compromised certificates.

*Third-party browser applications usually maintain a separate store of personal certificates and trusted root CAs.*

# Group Policy Editor
----

GUI tools such as Settings and Control Panel make changes to user profiles and the system configuration that are ultimately stored in a database called the registry. However, the registry also contains thousands of other settings that are not configurable via these tools. The **Group Policy Editor (gpedit.msc)** provides a more robust means of configuring many of these Windows settings than editing the registry directly. Also, vendors can write administrative templates to make third-party software configurable via policies.

![](Meta/Pasted%20image%2020231018134317.png)
*Using Group Policy Editor to view the local password policy. This computer does not have a strong set of policies.*

On a network with hundreds or thousands of computers, group policy is a much more efficient way of imposing policy settings than manually configuring each machine.

Some policies are configured by inputting a discrete value, but most use an enabled/disabled/not defined toggle. It is important to read each policy carefully when choosing whether it should be enabled or disabled and to understand the default behavior of leaving a setting not defined.

*The Local Security Policy editor (secpol.msc) can be used to modify security settings specifically.*

# Registry Editor
----

The Windows registry provides a remotely accessible database for storing operating system, device, and software application configuration information. You can use the **Registry Editor (regedit.exe)** to view or edit the registry.

### Registry Keys

The registry is structured as a set of five root keys that contain computer and user databases. The HKEY_LOCAL_MACHINE (HKLM) database governs system-wide settings. The HKEY_USERS database includes settings that apply to individual user profiles, such as desktop personalization. HKEY_CURRENT_USER is a subset of HKEY_USERS with the settings for logged in user.
![](Meta/Pasted%20image%2020231018134407.png)
*Registry root keys. Troubleshooting and editing activity is usually focused on either HKLM or HKCU.*

The registry database is stored in binary files called hives. A hive comprises a single file (with no extension), a .LOG file (containing a transaction log), and a .SAV file (a copy of the key as it was at the end of setup). The system hive also has an .ALT backup file. Most of these files are stored in the C:\Windows\System32\Config folder, but the hive file for each user profile (NTUSER.DAT) is stored in the folder holding the user's profile.

### Editing the Registry

Each root key can contain subkeys and data items called value entries. You can use the **Find** tool to search for a key or value.

Subkeys are analogous to folders, and the value entries are analogous to files. A value entry has three parts: the name of the value, the data type of the value (such as string or binary value), and the value itself.

*![](Meta/Pasted%20image%2020231018134457.png)
Editing the registry



If you want to copy portions of the registry database and use them on other computers, select **File > Export Registry File**. The file will be exported in a registry-compatible format and can be merged into another computer's registry by double-clicking the file (or calling it from a script).


# Custom Microsoft Management Consoles
----

A Microsoft Management Console (MMC) is a container for one or more snap-ins. For example, Device Manager, Disk Management, Group Policy Editor, and Certificate Manager are all snap-ins. The mmc command allows you to perform MMC customization and create a console with a personal selection of snap-ins. The console can be saved to the Administrative Tools folder as a file with an MSC extension.

![](Meta/Pasted%20image%2020231018135448.png)
*dding a snap-in to a custom console. This custom console can be used to manage both personal and computer certificates on the local host*


*Most MMC snap-ins can be used to manage either the local computer or a remote computer (a computer elsewhere on the network).*


# Review Management Consoles
----
1. You are supporting a user who has installed a vendor keyboard driver. The keyboard no longer functions correctly. Under Windows 10, what are the steps to revert to the previous driver?

Open Device Manager from the WinX menu, Instant Search, or the Computer Management console. Expand Keyboards, then right-click the device and select Properties. On the Driver tab, select Roll Back Driver.

2. You are troubleshooting an issue with a wireless adapter. When you open Device Manager, you find the device's icon is shown with a down arrow superimposed. What does this mean, and why might this configuration have been imposed?

The icon indicates that the device has been disabled. It could be that there was a fault, or there may be a network configuration or security reason for disabling the adapter. In this sort of situation, use incident logs and device documentation to establish the reason behind the configuration change.

3. If a single physical disk is divided into three partitions, how many different file systems can be supported?

Three—each partition can use a different file system.

4. True or false? The dfrgui.exe utility should be disabled if Windows is installed to an SSD.

False. While solid state drives (SSDs) and hard disk drives (HDDs) have different mechanical and performance characteristics, it is still necessary to run the Defragment and Optimize Drives (dfrgui.exe) periodically to optimize performance.

5. In Windows, what is the difference between the boot partition and the system partition?

The system partition contains the boot files; the boot partition contains the system root (OS files). The boot partition is normally assigned the drive letter C. The system partition is not normally assigned a drive letter.




----


Diagnosing the cause of errors and performance issues can be a difficult and frustrating task, but it can be made easier by knowing how to gather relevant information. If you can learn to use the system audit and monitoring/logging tools, you will be much better prepared to resolve slow performance problems.


----

# System Information
----

The **System Information (msinfo32.exe)** tool produces a comprehensive report about the system’s hardware and software components. Running the tool produces an inventory of system resources, firmware and OS versions, driver file locations, environment variables, network status, and so on.
![](Meta/Pasted%20image%2020231018135727.png)
*Sys Info Report*

# Event Viewer
----

When Windows detects a problem, it will usually generate an error message. This makes troubleshooting simpler as you may only need to find out what the error message means using the Microsoft Knowledge Base ([support.microsoft.com](https://support.microsoft.com/)) or third-party support sites and forums.

The **Event Viewer (eventvwr.msc)** is a management console snap-in for viewing and managing logs on a Windows host. The default page shows a summary of system status, with recent errors and warning events collected for viewing. The left-hand pane groups log files into different categories.

With a log file selected, the three-part middle pane lets you see the details of the selected event without having to open a separate dialog. The third pane contains useful tools for opening log files, filtering, creating a task from an event, and so on.

![](Meta/Pasted%20image%2020231018135800.png)
*Reviewing the Sys log in Win 10 Event Viewer Management Console*

### Default Log Files

The Windows Logs folder contains the four main log files:

- The System log contains information about events that affect the core OS. These include service load failures, hardware conflicts, driver load failures, network issues, and so on.
- The Application log contains information regarding non-core processes and utilities and some third-party apps. For example, app installers write events to the Application log.
- The Security log holds the audit data for the system.
- The Setup log records events generated during installation.

Each log file has a default maximum size (usually about 20 MB), but you can change this by selecting **Properties** on the appropriate log. This option also allows the overwrite option to be set either as overwrite, do not overwrite, or archive (close the current file and start a new one).

*Be careful about preserving logs. Many computers have ample free disk space, but archive logs can grow very large if left unmonitored.*

There are many other logs stored under the **Applications and Services Logs** node. You would investigate these when troubleshooting a particular Windows feature, service, or third-party application.

### Event Sources and Severity Levels

Each event is generated by a source application and allocated an ID and a severity level. The different event levels are as follows:

- **Critical**—An issue that should be treated as the highest priority in the context of the source application. Critical is often used to report a process that has halted or stopped responding.
- **Error**—A less severe issue that should be investigated once critical issues have been resolved.
- **Warning**—A state that could potentially lead to an error or critical condition if not remediated, such as the system running low on disk space.
- **Information**—Logs an operation or state that is noteworthy but does not require remediation.
- **Audit Success/Failure**—Events in the security log are classified as either successful, such as a user authenticating, or failed, such as a password not being entered correctly.

More information for each event can be displayed by double-clicking the event in question. This displays a screen that contains a full description of the event.

# Task Manager Process Monitor
----
The **Task Manager (taskmgr.exe)** tool can be used to monitor the PC's key resources. You can open it by pressing **CTRL+SHIFT+ESC**, by right-clicking the taskbar or Start, or by pressing **CTRL+ALT+DEL** and selecting Task Manager.

Task Manager may start in a summary mode; select the **Show details** button to expand it.

On the **Processes** tab, you can expand each app or background process to view its sub-processes and view more clearly what resources each is taking up.

![](Meta/Pasted%20image%2020231018135924.png)
*Win 10 Task Manager -- processes Tab*

The shortcut menu for a process allows you to end a task. There is also an option to search for information about the process online. Another option is to view more information about a process via the **Details** tab. For example, some background services run within the context of a process wrapper. You can identify services associated with each process via the shortcut menu on the **Details** tab.

In some circumstances, you may want to privilege one task over another or, conversely, set one task to have fewer resources than others. You can do this by right-clicking the process and choosing an option from the **Set Priority** submenu. For example, if you had a Voice over IP application and its priority was not already set to **Above normal**, changing its priority might improve call quality as the CPU would privilege that process over ones set to any other level.

# Task Manager Performance Monitor
----

The **Performance** tab provides more information about the CPU, memory, disk, network, and graphics processing unit (GPU) subsystems, while the **App History** tab shows usage information for Windows Store apps.

![](Meta/Pasted%20image%2020231018140011.png)
*Performance Tab in task manager*

### CPU and GPU Monitoring

The **CPU** page shows the number of cores and logical processors (HyperThreading), whether the system is multisocket, and whether virtualization is enabled. The statistics show overall utilization, system uptime, and a count of the number of processes, threads, and handles. Higher numbers indicate more activity. Each process can run operations in multiple threads and can open handles to files, registry keys, network pipes, and so on.

High peak values for utilization are nothing to worry about, but sustained periods of high utilization means that you should consider adding more resources to the system (or run fewer processes!).

The GPU page is shown if the system has a dedicated graphics adapter. It reports the amount of graphics memory available and utilization statistics.

### Memory Monitoring

The **Memory** page reports which slots have modules installed and the speed. The usage statistics are broken down as follows:

- **In use** refers to system (RAM) usage only.
- **Committed** reports the amount of memory requested and the total of system plus paged memory available. Paged memory refers to data that is written to a disk pagefile.
- **Cached** refers to fetching frequently used files into memory pre-emptively to speed up access.
- **Paged pool** and **non-paged pool** refer to OS kernel and driver usage of memory. Paged usage is processes that can be moved to the pagefile, while non-paged is processes that cannot be paged.

High physical memory utilization up to the amount of system RAM isn’t necessarily a sign of poor performance as it’s good to make full use of the resource. High pagefile utilization is more problematic.

### Disk Monitoring

The **Disk** pages report the type and capacity plus statistics for active time, response time, and read/write speeds.

*Note that utilization is measured across all disk devices. For example, 50% utilization could mean one disk working at 100% and the other seeing no activity.* 

High disk utilization and slow response times are a common cause of poor overall system performance issues. This could be a result of slow HDD technology, excessive paging activity, file/cache corruption, or a faulty device with bad sectors/blocks.

### Network Monitoring

The **Ethernet** or **Wi-Fi** tab reports send and receive throughput for the active network adapter plus the IP address and hardware (MAC) interface address. If a wireless adapter is active, the SSID, connection type (802.11 standard), and signal strength are also shown.

# Task Manager User Monitoring
----

The **Users** tab lets you see the people who are logged on (and allows you to send them a message or sign them out), the information about the processes they are running, and the resource utilization associated with their account.
![](Meta/Pasted%20image%2020231018140125.png)
*Using Task manager to manage users*

# Startup Processes and Services Console
----

The **Startup** tab lets you disable programs added to the Startup folder (type shell:startup at the Run dialog to access this) or set to run using the registry. Right-click the headers, and select **Startup type** to show how the program is launched. It also shows how much impact each item has on boot times.

The **Services** tab monitors the state of all registered background processes. A service is a Windows process that does not require any sort of user interaction and therefore runs in the background (without a window). Services provide functionality for many parts of the Windows OS, such as allowing logon, browsing the network, or indexing file details to optimize searches. Services may be installed by Windows and by other applications, such as antivirus, database, or backup software.

![](Meta/Pasted%20image%2020231018140205.png)
*Monitoring Service status using Task manager*

From Task Manager, the **Open Services** button links to the **Services (services.msc)** console. You can use this to disable nonessential services to improve performance or security. You can prevent a service from running at startup by setting it to **Manual** or prevent it from running completely by setting it to **Disabled**. Note that this may cause problems if other services depend upon it.

If something is not working properly, you should check that any services it depends upon are started. Restarting a service can be an effective first troubleshooting step.

# Resource Monitor and Performance Monitor
----

Task Manager can be used to assess key system statistics quickly, but there are other tools for more detailed performance monitoring.

### Resource Monitor

**Resource Monitor (resmon.exe)** shows an enhanced version of the sort of snapshot monitoring provided by Task Manager. You can see graphs of resource performance along with key statistics, such as threads started by a process or hard page faults/second. Continually rising numbers of either of these can indicate a problem.

![](Meta/Pasted%20image%2020231018140313.png)
*Viewing sys memory utilization in Resource Moniotr*

### Performance Monitor

Windows **Performance Monitor (perfmon.msc)** can be used to provide real-time charts of system resources or can be used to log information to a file for long-term analysis.

By monitoring different resources at different times of the day, you can detect bottlenecks in a system that are causing problems. It may be that a particular application starts freezing for longer and longer periods. This could be caused by a number of things. Perhaps the processor is too slow, which would cause the requests to take longer; perhaps the hard disk is too slow, which would mean that it takes too long for the computer to open and save files; perhaps the application uses a network link that has become faulty or congested.

The performance of the computer could be increased by upgrading any or all of these components, but Performance Monitor will help you decide which is critical.

In Performance Monitor, you can create log files, referred to as Data Collector Sets, to record information for viewing later. You can generate a library of performance measurements taken at different times of the day, week, or even year. This information can provide a system baseline and then be used to give a longer-term view of system performance.

There are two types of logs: counter and trace:

- Counter logs allow you to collect statistics about resources, such as memory, disk, and processor. These can be used to determine system health and performance.
- Trace logs can collect statistics about services, providing you with detailed reports about resource behavior. In essence, trace logs provide extensions to the Event Viewer, logging data that would otherwise be inaccessible.

Saved log files can be loaded into Performance Monitor from the Reports folder for analysis or exported to other programs.

# Performance Counters
----

To configure a counter log, you need to select what to monitor in the report. In Performance Monitor, resources such as memory and disk are collected into objects. Objects have counters that represent different performance statistics, and there can be multiple instances of the same type of object. For example, disk performance can be measured using the **Physical Disk Object**, and a useful counter is the **Average Queue Length**. If there are two disks, three instances of this object can be viewed: disk 0, disk 1, and disks Total.

![](Meta/Pasted%20image%2020231018140404.png)
*Using Performance Monitor to record 3 counter from PhysicalDisk and Memory Objects*

Some of the most used counters are listed here:

![](Meta/Pasted%20image%2020231018140535.png)


Notice that it is not always immediately apparent which component is causing a problem. Many counters are interrelated and must be viewed with other counters in mind. For instance, if your system memory is low, then the disk will likely be slow because of excessive paging.

# System Configuration Utility
----

The **System Configuration Utility (msconfig.exe)** is used to modify various settings and files that affect the way the computer boots and loads Windows.

*The msconfig tool is frequently used to test various configurations for diagnostic purposes, rather than to permanently make configuration changes. Following diagnostic testing, permanent changes would typically be made with more appropriate tools, such as **Services**, to change the startup settings of various system services.*

The **General** tab allows you to configure the startup mode, choosing between **Normal**, **Diagnostic**, and a **Selective** startup, where each portion of the boot sequence can be selected.

![](Meta/Pasted%20image%2020231018140626.png)

The **Boot** tab lets you configure basic settings in the **Boot Configuration Data (BCD)** store. You can change the default OS, add boot options (such as Safe Mode boot) with minimal drivers and services, and set the timeout value—the duration for which the boot options menu is displayed. To add boot paths, you have to use the bcdedit command.

![](Meta/Pasted%20image%2020231018140636.png)

*If you are troubleshooting a system that keeps using safe boot or boots to a command prompt, check that one of the previous options has not been made permanent in System Configuration.

You can also log boot events. This boot log file is saved to %SystemRoot%\ntbtlog.txt. It is not shown in Event Viewer**


The **Services** tab lets you choose specifically which services are configured to run at startup. The date that a service was disabled is also shown, to make troubleshooting easier. The **Tools** tab contains shortcuts to various administrative utilities, including System Information, Registry Editor, Performance Monitor, and so on.

# Review
----
2. You take a support call where the user doesn't understand why a program runs at startup when the Startup folder is empty. What is the likely cause, and how could you verify this?

The program has added a registry entry to run at startup. You could check this (and optionally disable the program) by using Task Manager.

3. You are monitoring CPU Usage and notice that it often jumps to 100% and then falls back. Does this indicate a problem?

Probably not—CPU Usage usually peaks and falls. If it stays over 80–90%, the system could require a faster CPU, or if it spikes continually, there could be a faulty application.

4. You have a computer with two SATA disks. You want to evaluate the performance of the primary disk. How would you select this in Performance Monitor, and what might be appropriate counters to use?

Select the Physical Disk object, select the counter, and then select the 0 C: instance. Counters that are useful for evaluating performance include % Disk Time and Average Disk Queue Length.

5. You are monitoring system performance and notice that a substantial number of page faults are occurring. Does this indicate that a memory module is faulty?

No—it shows the system is using the pagefile intensively and could benefit from more system RAM being installed.

